(()=>{"use strict";function e(e,n){var t=window.location.href;return fetch("http://127.0.0.1:8000/log_question/?question=".concat(encodeURIComponent(e),"&button=").concat(encodeURIComponent(n),"&current_url=").concat(encodeURIComponent(t)),{method:"GET"}).then((function(e){return e.json()})).then((function(e){return"success"!==e.status&&console.error("Failed to log question"),e})).catch((function(e){throw console.error("Error logging question:",e),e}))}var n=["o1-preview","gpt-4o","deepseek-reasoner"],t="o1-preview";function o(){return t}function r(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=performance.now(),r=document.getElementById("respons");c(r,"your_question",e);var i=c(r,"agent_response","FinGPT: Loading..."),a=document.getElementById("ragSwitch").checked,l=o();(function(e,n,t,o){var r=encodeURIComponent(e);return fetch("http://127.0.0.1:8000/".concat(t?"get_adv_response":"get_chat_response","/?question=").concat(r,"&models=").concat(n,"&is_advanced=").concat(t,"&use_rag=").concat(o),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){throw console.error("There was a problem with your fetch operation:",e),e}))})(e,l,n,a).then((function(e){var n=performance.now()-t;console.log("Time taken for response: ".concat(n," ms"));var o=e.resp[l];o?o.startsWith("The following file(s) are missing")?i.innerText="FinGPT: Error - ".concat(o):i.innerText="FinGPT: ".concat(o):i.innerText="FinGPT: (No response from server)",document.getElementById("textbox").value="",r.scrollTop=r.scrollHeight})).catch((function(e){console.error("There was a problem with your fetch operation:",e),i.innerText="FinGPT: Failed to load response."}))}function c(e,n,t){var o=document.createElement("span");return o.className=n,o.innerText=t,e.appendChild(o),o}function i(){var e=document.getElementById("respons"),n=document.getElementById("source_urls");e.innerHTML="",n&&(n.innerHTML=""),fetch("http://127.0.0.1:8000/clear_messages/",{method:"POST"}).then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()})).catch((function(e){throw console.error("There was a problem with your fetch operation:",e),e})).then((function(e){console.log(e)})).catch((function(e){console.error("There was a problem clearing messages:",e)}))}function a(){var n=document.getElementById("textbox").value;n?(r(n,!1),e(n,"Ask"),document.getElementById("textbox").value=""):alert("Please enter a question.")}function l(){var n=document.getElementById("textbox").value.trim();""!==n?(r(n,!0),e(n,"Advanced Ask"),document.getElementById("textbox").value=""):alert("Please enter a message.")}function d(){var e=document.createElement("div");return e.id="add_link_button",e.innerText="+",e.onclick=function(){var n,t=prompt("Enter a new preferred URL:");t&&(n=t,fetch("http://127.0.0.1:8000/api/add_preferred_url/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"url=".concat(encodeURIComponent(n))}).then((function(e){return e.json()})).catch((function(e){throw console.error("Error adding preferred link:",e),e}))).then((function(n){if("success"===n.status){var o=document.getElementById("preferred_links_content"),r=document.createElement("div");r.className="preferred-link-item",r.innerText=t,o.insertBefore(r,e)}else alert("Failed to add the new URL.")})).catch((function(e){return console.error("Error adding preferred link:",e)}))},e}function s(e,o,r){var c=document.createElement("div");c.style.display="none",c.id="settings_window";var i=document.createElement("label");i.innerText="Light Mode";var a=document.createElement("input");a.type="checkbox",a.onchange=function(){return document.body.classList.toggle("light-mode")},i.appendChild(a),c.appendChild(i);var l=document.createElement("div");l.id="model_selection_container";var s=document.createElement("div");s.id="model_selection_header",s.innerText="Model: ".concat(t);var u=document.createElement("span");u.innerText="â¯†",s.appendChild(u),l.appendChild(s);var p=document.createElement("div");p.id="model_selection_content",p.style.display="none",n.forEach((function(e){var n=document.createElement("div");n.className="model-selection-item",n.innerText=e,e===t&&n.classList.add("selected-model"),n.onclick=function(){return t=n,o=e,document.querySelectorAll(".model-selection-item").forEach((function(e){return e.classList.remove("selected-model")})),window.selectedModel=o,t.classList.add("selected-model"),s.innerText="Model: ".concat(o),void s.appendChild(u);var t,o},p.appendChild(n)})),l.appendChild(p),c.appendChild(l),s.onclick=function(){p.style.display="none"===p.style.display?"block":"none",u.innerText="none"===p.style.display?"â¯†":"â¯…"};var m=document.createElement("div");m.id="preferred_links_container";var h=document.createElement("div");h.id="preferred_links_header",h.innerText="Preferred Links";var v=document.createElement("span");v.innerText="â¯†",h.appendChild(v),m.appendChild(h);var f=document.createElement("div");f.id="preferred_links_content",f.appendChild(d()),m.appendChild(f),c.appendChild(m),h.onclick=function(){var e="none"===f.style.display;f.style.display=e?"block":"none",v.innerText=e?"â¯…":"â¯†"};var y=document.createElement("label");y.innerText="Local RAG";var g=document.createElement("input");return g.type="checkbox",g.id="ragSwitch",y.appendChild(g),c.appendChild(y),o.onclick=function(n){n.stopPropagation();var t=o.getBoundingClientRect(),r=t.bottom+(e.value?0:window.scrollY),i=t.left+(e.value?0:window.scrollX);c.style.top="".concat(r,"px"),c.style.left="".concat(i,"px"),c.style.display="none"===c.style.display?"block":"none",c.style.position=e.value?"fixed":"absolute","block"===c.style.display&&fetch("http://127.0.0.1:8000/api/get_preferred_urls/").then((function(e){return e.json()})).catch((function(e){throw console.error("Error loading preferred links:",e),e})).then((function(e){var n=document.getElementById("preferred_links_content");n.innerHTML="",e.urls.length>0&&e.urls.forEach((function(e){var t=document.createElement("div");t.className="preferred-link-item",t.innerText=e,n.appendChild(t)}));var t=document.getElementById("add_link_button")||d();n.appendChild(t)})).catch((function(e){return console.error("Error loading preferred links:",e)}))},document.addEventListener("click",(function(e){"block"!==c.style.display||c.contains(e.target)||o.contains(e.target)||r.contains(e.target)||(c.style.display="none")})),c}var u=window.location.href.toString();console.log("Current page: ",u);var p=document.body.innerText||"";encodeURIComponent(p),function(e,n){return fetch("http://127.0.0.1:8000/input_webtext/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({textContent:e,currentUrl:n})}).then((function(e){if(!e.ok)throw new Error("Network response was not ok (status: ".concat(e.status,")"));return e.json()})).then((function(e){return console.log("Response from server:",e),e})).catch((function(e){throw console.error("There was a problem with your fetch operation:",e),e}))}(p,u).then((function(e){console.log("Response from server:",e)})).catch((function(e){console.error("There was a problem with your fetch operation:",e)}));var m=function(){var e={value:!1},n=function(){var e=document.createElement("div");return e.id="draggableElement",e}(),t=document.createElement("span");t.innerText="âš™ï¸",t.className="icon";var o=document.createElement("span");o.innerText="ðŸ“Œ",o.id="position-mode-icon",o.className="icon";var r=s(e,t,o);o.onclick=function(){var c=n.getBoundingClientRect();if(e.value){n.style.position="absolute",n.style.top="".concat(c.top+window.scrollY,"px"),n.style.left="".concat(c.left+window.scrollX,"px"),o.innerText="ðŸ“Œ";var i=t.getBoundingClientRect();r.style.position="absolute",r.style.top="".concat(i.bottom+window.scrollY,"px"),r.style.left="".concat(i.left+window.scrollX,"px")}else{n.style.position="fixed",n.style.top="".concat(c.top,"px"),n.style.left="".concat(c.left,"px"),o.innerText="â›“ï¸â€ðŸ’¥";var a=t.getBoundingClientRect();r.style.position="fixed",r.style.top="".concat(a.bottom,"px"),r.style.left="".concat(a.left,"px")}e.value=!e.value};var c=function(e,n,t,o){var r=document.createElement("div");r.id="header",r.className="draggable";var c=document.createElement("span");c.innerText="FinGPT";var i=document.createElement("div");i.id="icon-container";var a=document.createElement("span");a.innerText="âž–",a.className="icon",a.onclick=function(){e.classList.contains("minimized")?(e.classList.remove("minimized"),e.style.height="600px"):(e.classList.add("minimized"),e.style.height="60px")};var l=document.createElement("span");return l.innerText="âŒ",l.className="icon",l.onclick=function(){e.style.display="none"},i.appendChild(t),i.appendChild(o),i.appendChild(a),i.appendChild(l),r.appendChild(c),r.appendChild(i),r}(n,0,t,o),d=document.createElement("div");d.id="intro";var u=document.createElement("h2");u.innerText="Your personalized financial assistant.";var p=document.createElement("p");p.id="subtitleText",p.innerText="Ask me something!",d.appendChild(p),d.appendChild(u),d.appendChild(p);var m=document.createElement("div");m.id="content";var h=document.createElement("div");h.id="respons",m.appendChild(h);var v=function(){var e=document.createElement("div");e.id="inputContainer";var n=document.createElement("div");n.id="modeButtonsContainer";var t=document.createElement("button");t.id="textModeButton",t.innerText="Text Mode",t.classList.add("mode-button","active-mode"),n.appendChild(t),e.appendChild(n);var o=document.createElement("input");o.type="text",o.id="textbox",o.placeholder="Type your question here...",o.addEventListener("keydown",(function(e){"Enter"===e.key&&a()})),e.appendChild(o);var r=document.createElement("div");r.id="buttonContainer";var c=document.createElement("button");c.id="askButton",c.innerText="Ask",c.onclick=a;var d=document.createElement("button");d.id="advAskButton",d.innerText="Advanced Ask",d.onclick=l,r.appendChild(c),r.appendChild(d);var s=document.createElement("div");s.className="button-row";var u=document.createElement("button");u.innerText="Clear",u.className="clear-button",u.onclick=i;var p=document.createElement("button");return p.innerText="Sources",p.className="sources-button",p.onclick=function(){!function(e){var n=document.getElementById("sources_window"),t=document.getElementById("loading_spinner"),o=document.getElementById("source_urls");n.style.display="block",t.style.display="block",o.style.display="none",function(e){return fetch("http://127.0.0.1:8000/get_source_urls/?query=".concat(String(e)),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){throw console.error("There was a problem with your fetch operation:",e),e}))}(e).then((function(e){console.log(e.resp);var n=e.resp;o.innerHTML="",n.forEach((function(e){var n=e[0],t=document.createElement("a");t.href=n,t.innerText=n,t.target="_blank";var r=document.createElement("li");r.appendChild(t),r.classList.add("source-item"),o.appendChild(r)})),t.style.display="none",o.style.display="block"})).catch((function(e){console.error("There was a problem getting sources:",e),t.style.display="none"}))}("")},s.appendChild(p),s.appendChild(u),{inputContainer:e,buttonContainer:r,buttonRow:s}}(),f=v.inputContainer,y=v.buttonContainer,g=v.buttonRow,E=document.createElement("div");E.id="sources_window",E.style.display="none";var w=document.createElement("div");w.id="sources_window_header";var x=document.createElement("h2");x.innerText="Sources";var C=document.createElement("span");C.innerText="âŒ",C.className="icon",C.onclick=function(){E.style.display="none"},w.appendChild(x),w.appendChild(C);var T=document.createElement("div");T.id="loading_spinner",T.className="spinner",T.style.display="none";var b=document.createElement("ul");b.id="source_urls",E.appendChild(w),E.appendChild(T),E.appendChild(b),n.appendChild(c),n.appendChild(d),n.appendChild(m),n.appendChild(g),n.appendChild(f),n.appendChild(y),document.body.appendChild(E),document.body.appendChild(r),document.body.appendChild(n),n.style.position="absolute",n.style.top="10%",n.style.left="10%",n.style.width="450px",n.style.height="650px",function(e){var n,t,o,r,c,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];function d(o){o.preventDefault();var r=o.clientX-n+(l?0:window.scrollX),c=o.clientY-t+(l?0:window.scrollY);e.style.left="".concat(r,"px"),e.style.top="".concat(c,"px");var i=document.getElementById("sources_window");i.style.left="".concat(r+e.offsetWidth+a,"px"),i.style.top="".concat(c,"px")}function s(n){n.preventDefault();var t=c+(n.clientX-o),l=i+(n.clientY-r);t>250&&(e.style.width="".concat(t,"px")),l>300&&(e.style.height="".concat(l,"px")),document.getElementById("sources_window").style.left="".concat(e.offsetLeft+e.offsetWidth+a,"px")}function u(){document.removeEventListener("mousemove",d),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",u)}e.querySelector(".draggable").addEventListener("mousedown",(function(a){if(!["INPUT","TEXTAREA","BUTTON","A"].includes(a.target.tagName)&&"position-mode-icon"!==a.target.id){a.preventDefault();var l=e.getBoundingClientRect(),p=a.clientX>l.right-10,m=a.clientY>l.bottom-10;p||m?(o=a.clientX,r=a.clientY,c=l.width,i=l.height,document.addEventListener("mousemove",s)):(n=a.clientX-l.left,t=a.clientY-l.top,document.addEventListener("mousemove",d)),document.addEventListener("mouseup",u)}}))}(n,10,e.value);var k=n.getBoundingClientRect();return E.style.left="".concat(k.right+10,"px"),E.style.top="".concat(k.top,"px"),console.log("initalized"),{popup:n,settings_window:r,sources_window:E,searchQuery:""}}();m.popup,m.settings_window,m.sources_window,m.searchQuery})();
//# sourceMappingURL=bundle.js.map